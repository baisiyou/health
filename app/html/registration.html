<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Form - Empathy Canada</title>
    <link href="../css/styles.css" rel="stylesheet">
    <link href="../css/hybrid-model.css" rel="stylesheet">
    <script src='../js/base-path.js'></script>
    <script type='module' src='../js/patient-form.js'></script>
    <script src="../js/hybrid-model.js"></script>
</head>
<body>

    <!-- Navigation Bar -->
    <div id="navbar-container"></div>
    <script>
        // Determine base path for GitHub Pages
        const basePath = window.location.hostname === 'baisiyou.github.io' ? '/health' : '';
        fetch(`${basePath}/components/navbar.html`)
            .then(response => response.text())
            .then(data => {
                document.getElementById("navbar-container").innerHTML = data;
            })
            .catch(error => console.error("Error loading navbar:", error));
    </script>

    <!-- Patient Form -->
    <section class="patient-form-container">
        <h1>Patient Form</h1>
        <form id="patient-form">
            <fieldset>
                <legend>Personal Information</legend>
                <label for="name">Full Name:</label>
                <input type="text" id="name" name="name" required>
                <label for="dob">Date of Birth:</label>
                <input type="date" id="dob" name="dob" required placeholder="yyyy-mm-dd">
                <label for="age">Age:</label>
                <input type="number" id="age" name="age" required>
                <label for="accompanied">Accompanied By:</label>
                <input type="text" id="accompanied" name="accompanied">
                <label for="relationship">Relationship:</label>
                <input type="text" id="relationship" name="relationship">
            </fieldset>
            
            <fieldset>
                <legend>Prenatal History</legend>
                <label for="prenatal-visit">First Prenatal Visit Date:</label>
                <input type="date" id="prenatal-visit" name="prenatal-visit" placeholder="yyyy-mm-dd">
                <label for="alcohol">Alcohol Consumption:</label>
                <input type="text" id="alcohol" name="alcohol">
                <label for="tobacco">Tobacco Use:</label>
                <input type="text" id="tobacco" name="tobacco">
                <label for="drugs">Street Drugs:</label>
                <input type="text" id="drugs" name="drugs">
            </fieldset>
            
            <fieldset>
                <legend>Medical History</legend>
                <label for="stds">STDs (Specify):</label>
                <input type="text" id="stds" name="stds">
                <label for="hepatitis">Hepatitis B:</label>
                <input type="checkbox" id="hepatitis" name="hepatitis">
                <label for="hiv">HIV:</label>
                <input type="checkbox" id="hiv" name="hiv">
                <label for="birth-weight">Birth Weight:</label>
                <input type="text" id="birth-weight" name="birth-weight">
                <label for="allergies">Allergies:</label>
                <input type="text" id="allergies" name="allergies">
                <label for="prescriptions">Current/Previous Prescriptions:</label>
                <textarea id="prescriptions" name="prescriptions" rows="3"></textarea>
            </fieldset>
            
            <fieldset>
                <legend>Physical Exam</legend>
                <label for="height">Height:</label>
                <input type="number" id="height" name="height" step="0.1">
                <label for="weight">Weight:</label>
                <input type="number" id="weight" name="weight" step="0.1">
                <label for="head-circumference">Head Circumference:</label>
                <input type="number" id="head-circumference" name="head-circumference" step="0.1">
            </fieldset>
            
            <fieldset>
                <legend>Lab Values (Optional - for AI Risk Assessment)</legend>
                <label for="blood-glucose">Blood Glucose (mg/dL):</label>
                <input type="number" id="blood-glucose" name="blood-glucose" step="0.1">
                <label for="cholesterol">Total Cholesterol (mg/dL):</label>
                <input type="number" id="cholesterol" name="cholesterol" step="0.1">
                <label for="hdl">HDL Cholesterol (mg/dL):</label>
                <input type="number" id="hdl" name="hdl" step="0.1">
                <label for="ldl">LDL Cholesterol (mg/dL):</label>
                <input type="number" id="ldl" name="ldl" step="0.1">
                <label for="bun">Blood Urea Nitrogen (mg/dL):</label>
                <input type="number" id="bun" name="bun" step="0.1">
                <label for="creatinine">Creatinine (mg/dL):</label>
                <input type="number" id="creatinine" name="creatinine" step="0.1">
                <label for="hba1c">HbA1c (%):</label>
                <input type="number" id="hba1c" name="hba1c" step="0.1">
            </fieldset>
            
            <fieldset>
                <legend>Clinical Notes (for AI Disease Diagnosis)</legend>
                <label for="clinical-notes">Additional Clinical Notes:</label>
                <textarea id="clinical-notes" name="clinical-notes" rows="4" 
                          placeholder="Enter any additional clinical observations, symptoms, or notes for AI analysis..."></textarea>
            </fieldset>
            
            <button type="button" class="hybrid-analyze-btn" onclick="performHybridAnalysis()" 
                    style="background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; margin: 10px 0; width: 100%; max-width: 300px; display: block; margin-left: auto; margin-right: auto;">
                ðŸ§  Hybrid AI Disease Diagnosis
            </button>
            
            <button type="submit">Submit</button>
        </form>
        <p id="response-message" style="color: green; display: none;">Form submitted successfully!</p>
    </section>

    <!-- âœ… New: Display Retrieved Patient Records -->
    <section class="patient-records">
        <h2>Patient Records</h2>
        <div id="patient-results">
            <!-- Retrieved patient data will be displayed here -->
        </div>
    </section>

    <!-- Footer Section -->
    <div id="footer-container"></div>
    <script>
        // Determine base path for GitHub Pages
        const basePathFooter = window.location.hostname === 'baisiyou.github.io' ? '/health' : '';
        fetch(`${basePathFooter}/components/footer.html`)
            .then(response => response.text())
            .then(data => {
                document.getElementById("footer-container").innerHTML = data;
            })
            .catch(error => console.error("Error loading footer:", error));
    </script>

</body>
</html>
